% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/write_bioc.R
\name{write_soma.SingleCellExperiment}
\alias{write_soma.SingleCellExperiment}
\title{Write a \code{\link[SingleCellExperiment:SingleCellExperiment-class]{SingleCellExperiment}}
object to a SOMA}
\usage{
\method{write_soma}{SingleCellExperiment}(
  x,
  uri,
  ms_name = NULL,
  ...,
  ingest_mode = "write",
  platform_config = NULL,
  tiledbsoma_ctx = NULL
)
}
\arguments{
\item{x}{An object.}

\item{uri}{URI for resulting SOMA object.}

\item{ms_name}{Name for resulting measurement; defaults to
\code{\link[SingleCellExperiment]{mainExpName}(x)}.}

\item{...}{Arguments passed to other methods}

\item{ingest_mode}{Ingestion mode when creating the SOMA; choose from:
\itemize{
\item \dQuote{\code{write}}: create a new SOMA and error if it already
exists.
\item \dQuote{\code{resume}}: attempt to create a new SOMA; if it already
exists, simply open it for writing.
}}

\item{platform_config}{Optional \link[tiledbsoma:PlatformConfig]{platform
configuration}.}

\item{tiledbsoma_ctx}{Optional \code{\link{SOMATileDBContext}}.}
}
\value{
The URI to the resulting \code{\link{SOMAExperiment}} generated from
the data contained in \code{x}.
}
\description{
Write a \code{\link[SingleCellExperiment:SingleCellExperiment-class]{SingleCellExperiment}}
object to a SOMA
}
\section{Writing Reduced Dimensions}{

Reduced dimensions are written out as
\link[tiledbsoma:SOMASparseNDArray]{sparse matrices} within the \code{obsm}
group of \code{\link[tiledbsoma:SOMAMeasurement]{measurement}}
named \code{ms_name}.
}

\section{Writing Column Pairs}{

Column-wise relationship matrices are written out as
\link[tiledbsoma:SOMASparseNDArray]{sparse matrices} within the
\code{obsp} group of \code{\link[tiledbsoma:SOMAMeasurement]{measurement}}
named \code{ms_name}.
}

\section{Writing Row Pairs}{

Row-wise relationship matrices are written out as
\link[tiledbsoma:SOMASparseNDArray]{sparse matrices} within the
\code{varp} group of \code{\link[tiledbsoma:SOMAMeasurement]{measurement}}
named \code{ms_name}.
}

\section{Writing \code{colData}}{

\code{colData} is written out as a
\link[tiledbsoma:SOMADataFrame]{data frame} called \dQuote{\code{obs}} at
the \code{\link[tiledbsoma:SOMAExperiment]{experiment}} level.
}

\section{Writing Assay Matrices}{

Each \link[SummarizedExperiment:assay]{assay matrix} is written out as a
\link[tiledbsoma:SOMASparseNDArray]{sparse matrix} within the \code{X} group
of \code{\link[tiledbsoma:SOMAMeasurement]{measurement}} named
\code{ms_name}. Names for assay matrices within \code{X} are taken from the
\link[SummarizedExperiment:assayNames]{assay names}. Assay matrices are
transposed (samples as rows) prior to writing.
}

\section{Writing \code{rowData}}{

\code{rowData} is written out as a
\link[tiledbsoma:SOMADataFrame]{data frame} called \dQuote{\code{var}} at
the \code{\link[tiledbsoma:SOMAMeasurement]{measurement}} level.
}

\examples{
\dontshow{if (requireNamespace("withr", quietly = TRUE) && requireNamespace("SingleCellExperiment", quietly = TRUE)) (if (getRversion() >= "3.4") withAutoprint else force)(\{ # examplesIf}
uri <- withr::local_tempfile(pattern = "single-cell-experiment")

mat <- abs(Matrix::rsparsematrix(
  230L,
  80L,
  0.3,
  dimnames = list(paste0("feature_", seq_len(230)), paste0("cell_", seq_len(80)))
))
(sce <- SingleCellExperiment::SingleCellExperiment(
  assays = list(counts = mat, logcounts = log2(mat + 1L)),
  reducedDims = list(
    pca = matrix(stats::runif(80 * 5L), nrow = 80),
    tsne = matrix(stats::rnorm(80 * 2L), nrow = 80)
  ),
  mainExpName = "RNA"
))

uri <- write_soma(sce, uri)

(exp <- SOMAExperimentOpen(uri))
exp$obs
(ms <- exp$ms$get("RNA"))
ms$var
ms$X$names()
ms$obsm$names()

\dontshow{
exp$close()
}
\dontshow{\}) # examplesIf}
}
