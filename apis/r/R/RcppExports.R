# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Read SOMA Data From a Given URI
#'
#' This functions access a given SOMA URI and returns a complete data.frame. It does
#' not iterate; if your data is large than the initial read size consider the \code{sr_*}
#' functions.
#'
#' @param uri Character value with URI path to a SOMA data set
#' @param colnames Optional vector of character value with the name of the columns to retrieve
#' @param qc Optional external Pointer object to TileDB Query Condition, defaults to \sQuote{NULL} i.e.
#' no query condition
#' @param dim_points Optional named list with vector of data points to select on the given
#' dimension(s). Each dimension can be one entry in the list.
#' @param dim_ranges Optional named list with two-column matrix where each row select a range
#' for the given dimension. Each dimension can be one entry in the list.
#' @param batch_size Character value with the desired batch size, defaults to \sQuote{auto}
#' @param result_order Character value with the desired result order, defaults to \sQuote{auto}
#' @param loglevel Character value with the desired logging level, defaults to \sQuote{auto}
#' which lets prior setting prevail, any other value is set as new logging level.
#' @param arrlst A list containing the pointers to an Arrow data structure
#' @param xp An external pointer to an ArrowSchema or ArrowData
#' @return A List object with two pointers to Arrow array data and schema is returned
#' @examples
#' \dontrun{
#' uri <- "test/soco/pbmc3k_processed/obs"
#' z <- soma_reader(uri)
#' tb <- as_arrow_table(z)
#' }
#' @export
soma_reader <- function(uri, colnames = NULL, qc = NULL, dim_points = NULL, dim_ranges = NULL, batch_size = "auto", result_order = "auto", loglevel = "auto") {
    .Call(`_tiledbsoma_soma_reader`, uri, colnames, qc, dim_points, dim_ranges, batch_size, result_order, loglevel)
}

#' @noRd
set_log_level <- function(level) {
    invisible(.Call(`_tiledbsoma_set_log_level`, level))
}

#' @noRd
get_column_types <- function(uri, colnames) {
    .Call(`_tiledbsoma_get_column_types`, uri, colnames)
}

#' @rdname soma_reader
#' @export
nnz <- function(uri) {
    .Call(`_tiledbsoma_nnz`, uri)
}

#' @rdname soma_reader
check_arrow_schema_tag <- function(xp) {
    .Call(`_tiledbsoma_check_arrow_schema_tag`, xp)
}

#' @rdname soma_reader
check_arrow_array_tag <- function(xp) {
    .Call(`_tiledbsoma_check_arrow_array_tag`, xp)
}

#' Iterator-Style Access to SOMA Array via SOMAReader
#'
#' The `sr_*` functions provide low-level access to an instance of the SOMAReader
#' class so that iterative access over parts of a (large) array is possible.
#' \describe{
#'   \item{\code{sr_setup}}{instantiates and by default also submits a query}
#'   \item{\code{sr_complete}}{checks if more data is available}
#'   \item{\code{sr_next}}{returns the next chunk}
#' }
#'
#' @param ctx An external pointer to a TileDB Context object
#' @param uri Character value with URI path to a SOMA data set
#' @param colnames Optional vector of character value with the name of the columns to retrieve
#' @param qc Optional external Pointer object to TileDB Query Condition, defaults to \sQuote{NULL} i.e.
#' no query condition
#' @param dim_points Optional named list with vector of data points to select on the given
#' dimension(s). Each dimension can be one entry in the list.
#' @param dim_ranges Optional named list with two-column matrix where each row select a range
#' for the given dimension. Each dimension can be one entry in the list.
#' @param config Optional named chracter vector with \sQuote{key} and \sQuote{value} pairs
#' used as TileDB config parameters. If unset default configuration is used.
#' @param loglevel Character value with the desired logging level, defaults to \sQuote{auto}
#' which lets prior setting prevail, any other value is set as new logging level.
#' @param sr An external pointer to a TileDB SOMAReader object
#'
#' @return \code{sr_setup} returns an external pointer to a SOMAReader. \code{sr_complete}
#' returns a boolean, and \code{sr_next} returns an Arrow array helper object.
#'
#' @examples
#' \dontrun{
#' ctx <- tiledb::tiledb_ctx()
#' uri <- "test/soco/pbmc3k_processed/obs"
#' sr <- sr_setup(ctx@ptr, uri, "warn")
#' rl <- data.frame()
#' while (nrow(rl) == 0 || !tiledbsoma:::sr_complete(sr)) {
#'     dat <- tiledbsoma:::sr_next(sr)
#'     dat |>
#'         as_arrow_table() |>
#'         collect() |>
#'         as.data.frame() |>
#'         data.table() -> D
#'     rl <- rbind(rl, D)
#' }
#' summary(rl)
#' }
#' @export
sr_setup <- function(ctx, uri, colnames = NULL, qc = NULL, dim_points = NULL, dim_ranges = NULL, config = NULL, loglevel = "auto") {
    .Call(`_tiledbsoma_sr_setup`, ctx, uri, colnames, qc, dim_points, dim_ranges, config, loglevel)
}

#' @rdname sr_setup
#' @export
sr_complete <- function(sr) {
    .Call(`_tiledbsoma_sr_complete`, sr)
}

#' @rdname sr_setup
#' @export
sr_next <- function(sr) {
    .Call(`_tiledbsoma_sr_next`, sr)
}

#' TileDB Statistics interface
#'
#' The functions `tiledbsoma_stats_enable`, `tiledbsoma_stats_disable`, `tiledbsoma_stats_reset`
#' and `tiledbsoma_stats_dump` expose the TileDB Core functionality for performance measurements
#' and statistics.  The first three just turn on, off or reset, the fourth returns a JSON string.
#' For convenience the function `tiledbsoma_stats_show` displays the information on the console
#'
#' @export
tiledbsoma_stats_enable <- function() {
    invisible(.Call(`_tiledbsoma_tiledbsoma_stats_enable`))
}

#' @rdname tiledbsoma_stats_enable
#' @export
tiledbsoma_stats_disable <- function() {
    invisible(.Call(`_tiledbsoma_tiledbsoma_stats_disable`))
}

#' @rdname tiledbsoma_stats_enable
#' @export
tiledbsoma_stats_reset <- function() {
    invisible(.Call(`_tiledbsoma_tiledbsoma_stats_reset`))
}

#' @rdname tiledbsoma_stats_enable
#' @export
tiledbsoma_stats_dump <- function() {
    .Call(`_tiledbsoma_tiledbsoma_stats_dump`)
}

